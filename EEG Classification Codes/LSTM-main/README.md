


运行Xmuse.py

下面是代码解释：
1.准备数据集
将脑电数据集导入Pycharm，即设置EEG文件夹的路径。此路径包含前期已经处理好的所有被试的数据文件。

![image](https://github.com/user-attachments/assets/163a4e47-cf9b-4992-9de5-13a7408a17b5)


2.读取数据集
读取所有.CSV文件
将被试的标签存储在数组中（0表示非焦虑，1表示焦虑）。
将读取的文件和存储标签的数组传入加载函数，用来加载数据并为每个文件分配标签。

![image](https://github.com/user-attachments/assets/3cabc48f-ac71-4a2e-a8e9-056180c230c9)


3.划分数据集
加载完数据之后，将数据集划分为训练集和测试集

![image](https://github.com/user-attachments/assets/3227b134-e1f1-4992-a50c-acc97c7a56b6)


4.模型构建与训练
以LSTM模型为例：
通过Sequential()函数创建了一个顺序模型，这个模型的特点是允许我们按顺序堆叠各个网络层，为后续层的构建提供了基础架构。
模型的核心部分是LSTM层，这是一种特殊的递归神经网络，能够捕获序列数据中的时间依赖特征，非常适合处理像 EEG 这种时间序列数据。在这一层中，我们明确指定了输入数据的时间步长和特征数，从而确保模型能够准确理解数据的结构和维度。
在 LSTM 层之后，添加了Dropout层，这是防止过拟合的一种正则化方法，每次更新参数时随机丢弃一定比例的神经元，从而避免模型过于依赖某些特定神经元的权重。
还加入了批量归一化层，对每一层的输出进行归一化处理，有助于加速模型的收敛速度并提高模型的泛化能力。
最后是全连接层，使用sigmoid激活函数，将输出值映射到 0 和 1 之间，使模型能够完成二分类任务。
模型设计完成后，对模型进行编译，就可以开始训练了。

![image](https://github.com/user-attachments/assets/f8b4a0f9-0fb7-4c59-9ad2-4e37e71396b8)


5.设置超参数
编译过程的核心是优化器、学习率、损失函数和评估指标的设置，确保模型能够有效地学习并准确衡量其性能。以下图为例，这里使用的是Adam优化器，学习率为0.001，使用二元交叉熵损失函数，适用于二分类问题，使用评估指标准确率，用于监控模型在训练和测试过程中的准确率

![image](https://github.com/user-attachments/assets/145d524c-4524-4cd0-b7e1-9a014c0af7f4)


在训练过程中，我们指定了训练轮数为 10，批量大小为 1，也就是说，每次参数更新都会用一个样本，而整个训练会循环 10 次。
![image](https://github.com/user-attachments/assets/3f0d5ed1-c29e-407a-8256-887ce5bf6b18)


5.得到训练结果
在训练完成后，我们可以获得每一轮的训练准确率，并将这些准确率绘制成曲线，清晰地展示模型的学习效果。
![image](https://github.com/user-attachments/assets/25d87682-68c1-41e3-b62e-68d8a1f3bd33)

